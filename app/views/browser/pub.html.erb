<script>
  function goBack() {
    window.history.back();
}
</script>

<div onclick="goBack()" style="display:inline; text-align: left; color:blue; width: 20px; font-weight: 300"><a>Back</a></div>
<%
if current_user then
    if !current_user.group_id.blank? and !current_user.group_id.nil? then
        #if user has an associated group value, we want to display a select button to allow them to pick this brewery as a destination.  Dislay the select.
        %>
        <div onclick="goBack()" style="display:inline; float:right; padding-right: 2%; color:blue; width: 20px; font-weight: 300"><a>Select</a></div>
        
        <div class="input-field">
          <%
          #this was code to limit distance radius.
          #if params[:dist].nil? or params[:dist].blank?
          #  @distDefault = 10
          #elsif params[:dist].to_f < 0.5
          #  @distDefault = 10
          #  @maxPubDist = 10
          #else
          #  @distDefault = params[:dist]
          #end
          
          
          @userGroups = []
          
          @allGroups = Group.all
          #get a list of user groups
            
            @allGroups.each do |g|
              current_user.group_id.each do |c|
                if c == g.id
                    @userGroups << c
                end
              end
            end
          %>
          
          <form action="/selectBrewery/<%=@pub.id%>">
            <%
            %>
           <p>Select a Group:</p>
            <select id="group_id" name="group_id">
              <%
              @userGroups.each do |ug|
                %>
                <option value="<%=ug%>"><%=ug%></option>
                <%
              end
              %>
            </select>
            <input type="submit" value="Submit">
          </form>
        </div>
        <%
    end
end
%>


<div style="text-align: center">
<!---<h1>Brewery Info</h1>--->
<h2><%= @pub.name %></h2>
<% begin
  @pub.imgUrl %>
  <img src="<%= @pub.imgUrl %>" alt="Picture">
<% rescue %>
<% end %>

<p style="font-weight:bold"><%= @pub.address %>, <%= @pub.locality%></p>
<a target="_blank" href="<%=@pub.website%>"><p><%=@pub.website%></p></a>

<p style="white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; "><%= @pub.description %></p>






<style>
  #map {
    display: inline-block;
    height: 300px;
    width: 400px;
  }
</style>
  <div id="map"></div>
  <%
  if @pubBeers.count > 0
  %>


  <h3>Beers at this Location:</h3>
  <table style="display: inline-block; text-align: center;">
    <thead>
      <tr style="text-decoration: underline">
        <td><b><p>Name</p></b></td>
        <td><b><p>Bitterness</p></b></td>
        <td><b><p>Alcohol Content</p></b></td>
        <td><b><p>Lightness</p></b></td>
        <td><b><p>Style</p></b></td>

      </tr>
    </thead>
    <tbody>
  <%
  @pubBeers.each do |pb|
    %>
    <tr>
      <%
      #@pub = Brewery.find(params[:id])
      @assocStyle = Style.where(:style_id => pb.style_id).first
      %>
      <td><%=pb.name%></td>
      <td><%=pb.ibu%></td>

      <%
      if pb.abv.blank?
        %>
        <td><%=pb.abv%></td>
        <%
      else
        %>
      <td><%=pb.abv%>%</td>
      <%
      end

      %>

      <td><%=pb.srmId%></td>
      <%
      if @assocStyle
        %>
        <td><a href="/style/<%=@assocStyle.id%>"><%=@assocStyle.name%></a></td>
        <%
      end

      %>
    </tr>
    <%
  end
  %>
  </tbody>
  </table>

<%end%>
</div>
  <script>
    var map;
    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: <%= @pub.latitude %>, lng: <%= @pub.longitude %>},
        zoom: 15
      });
      var marker = new google.maps.Marker({
        position: {lat: <%= @pub.latitude %>, lng: <%= @pub.longitude %>},
        map: map,
        title: '<%= @pub.name %>'
    });
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCyx6w96mmMia6L8Rd__mCfaOxFO5sbFlE&callback=initMap"
  async defer></script>
